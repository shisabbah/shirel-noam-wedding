<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shirel & Noam - Invitation Mariage</title>
    <!-- Open Graph / Social preview -->
    <meta property="og:title" content="Invitation mariage Shirel & Noam" />
    <meta property="og:description" content="Vous Ãªtes invitÃ© au mariage de Shirel et Noam le 25 fÃ©vrier." />
    <meta property="og:image" content="https://shisabbah.github.io/shirel-noam-wedding/logo.png" />
    <meta property="og:url" content="https://shisabbah.github.io/shirel-noam-wedding/" />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="fr_FR" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Invitation mariage Shirel & Noam" />
    <meta name="twitter:description" content="Vous Ãªtes invitÃ© au mariage de Shirel et Noam le 25 fÃ©vrier." />
    <meta name="twitter:image" content="https://shisabbah.github.io/shirel-noam-wedding/logo.png" />
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="first-page" id="firstPage">
        <img src="new-accueil.png" alt="Accueil" class="fullscreen-image clickable" id="part1">
    </div>
    <div class="scroll-container hidden" id="scrollContainer">
        <button class="nav-button nav-prev" id="prevPage" aria-label="Page prÃ©cÃ©dente">â€¹</button>
        <div class="image-wrapper">
            <img src="mairie.png" alt="Mairie" class="scroll-image active">
            <img src="henne.png" alt="Henne" class="scroll-image">
            <img src="houppa.png" alt="Houppa" class="scroll-image">
            <div class="scroll-image form-container" style="background-image: url('form.png'); background-size: contain; background-position: center; background-repeat: no-repeat;">
                <form
                    class="wedding-form"
                    method="POST"
                    action="https://script.google.com/macros/s/AKfycby3v4vpL0UjqJSlQ3FqmYOl63Breg3NB_Tmxi8-CQ4gtUYTZja8kEOvUi2PWMMotpnFRA/exec"
                    target="hidden_iframe">
                    <h2 class="form-title">RÃ©pondez Ã  l'invitation</h2>
                    
                    <div class="form-group">
                        <label for="prenom">PrÃ©nom</label>
                        <input type="text" id="prenom" name="prenom" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="nom">Nom</label>
                        <input type="text" id="nom" name="nom" required>
                    </div>
                    
                    <div class="form-group checkbox-group">
                        <div class="checkboxes">
                            <div class="event-item">
                                <label for="nb_mairie" class="event-title">Mairie</label>
                                <input type="number" name="nb_mairie" id="nb_mairie" min="0" value="0" class="event-number">
                            </div>
                            <div class="event-item">
                                <label for="nb_henne" class="event-title">HennÃ©</label>
                                <input type="number" name="nb_henne" id="nb_henne" min="0" value="0" class="event-number">
                            </div>
                            <div class="event-item">
                                <label for="nb_mariage" class="event-title">Mariage</label>
                                <input type="number" name="nb_mariage" id="nb_mariage" min="0" value="0" class="event-number">
                            </div>
                        </div>
                    </div>
                    
                    <button type="submit" class="submit-btn">Envoyer</button>
                </form>
            </div>
        </div>
        <button class="nav-button nav-next" id="nextPage" aria-label="Page suivante">â€º</button>
        <div class="page-indicator" id="pageIndicator">1 / 4</div>
    </div>
    <script>
        const part1 = document.getElementById('part1');
        const firstPage = document.getElementById('firstPage');
        const scrollContainer = document.getElementById('scrollContainer');
        const scrollImages = Array.from(document.querySelectorAll('.scroll-image'));
        const prevPageBtn = document.getElementById('prevPage');
        const nextPageBtn = document.getElementById('nextPage');
        const pageIndicator = document.getElementById('pageIndicator');
        let currentIndex = 0;

        part1.addEventListener('click', function() {
            firstPage.style.opacity = '0';
            firstPage.style.transform = 'scale(0.95)';
            setTimeout(() => {
                firstPage.classList.add('hidden');
                scrollContainer.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            }, 300);
        });

        function updatePages(direction) {
            scrollImages.forEach((img, index) => {
                img.classList.remove('active', 'from-left', 'from-right');
                if (index === currentIndex) {
                    img.classList.add('active');
                    if (direction === 'next') img.classList.add('from-right');
                    if (direction === 'prev') img.classList.add('from-left');
                }
            });
            if (pageIndicator) {
                pageIndicator.textContent = (currentIndex + 1) + ' / ' + scrollImages.length;
            }
            if (prevPageBtn && nextPageBtn) {
                prevPageBtn.disabled = currentIndex === 0;
                nextPageBtn.disabled = currentIndex === scrollImages.length - 1;
            }
        }

        if (prevPageBtn && nextPageBtn) {
            prevPageBtn.addEventListener('click', function () {
                if (currentIndex > 0) {
                    currentIndex--;
                    updatePages('prev');
                }
            });

            nextPageBtn.addEventListener('click', function () {
                if (currentIndex < scrollImages.length - 1) {
                    currentIndex++;
                    updatePages('next');
                }
            });
        }

        // Navigation clavier (flÃ¨ches)
        document.addEventListener('keydown', function (e) {
            if (scrollContainer.classList.contains('hidden')) return;
            if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
                if (currentIndex < scrollImages.length - 1) {
                    currentIndex++;
                    updatePages('next');
                }
            } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
                if (currentIndex > 0) {
                    currentIndex--;
                    updatePages('prev');
                }
            }
        });

        // Initialisation
        updatePages();

        // Message de confirmation aprÃ¨s envoi du formulaire (via l'iframe cachÃ©)
        const hiddenIframe = document.querySelector('iframe[name="hidden_iframe"]');
        const successOverlay = document.getElementById('successOverlay');
        const successClose = document.getElementById('successClose');

        let iframeFirstLoad = true;
        if (hiddenIframe) {
            hiddenIframe.addEventListener('load', function () {
                // On ignore le tout premier chargement (about:blank)
                if (iframeFirstLoad) {
                    iframeFirstLoad = false;
                    return;
                }

                const form = document.querySelector('.wedding-form');
                if (form) {
                    form.reset();
                }

                const nbMairie = document.getElementById('nb_mairie');
                const nbHenne = document.getElementById('nb_henne');
                const nbMariage = document.getElementById('nb_mariage');

                if (nbMairie) nbMairie.value = 0;
                if (nbHenne) nbHenne.value = 0;
                if (nbMariage) nbMariage.value = 0;

                if (successOverlay) {
                    successOverlay.style.display = 'flex';
                } else {
                    alert('Merci pour votre rÃ©ponse ðŸ’•');
                }
            });
        }

        if (successClose && successOverlay) {
            successClose.addEventListener('click', function () {
                successOverlay.style.display = 'none';
            });
        }
    </script>
    <iframe name="hidden_iframe" style="display:none;"></iframe>
    <div id="successOverlay" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); color:#fff; z-index:9999; align-items:center; justify-content:center; padding:20px; text-align:center;">
        <div style="background:#222; padding:20px 24px; border-radius:10px; max-width:320px; width:100%; box-shadow:0 8px 20px rgba(0,0,0,0.4);">
            <p style="margin:0 0 16px; font-size:18px; font-weight:600;">Merci pour votre rÃ©ponse ðŸ’•</p>
            <button id="successClose" style="padding:10px 16px; border:none; border-radius:6px; background:#f2c6d1; color:#222; font-weight:700; cursor:pointer; width:100%;">Fermer</button>
        </div>
    </div>
</body>
</html>
